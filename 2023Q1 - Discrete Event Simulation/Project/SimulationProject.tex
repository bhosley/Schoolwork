%\documentclass[12pt]{journal}
\documentclass[sigplan,nonacm]{acmart}
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}

%\usepackage{amsmath,amssymb,amsthm}
\usepackage{tcolorbox}
\newtcbox{\inlinecode}{on line, boxrule=0pt, boxsep=0pt, top=2pt, left=2pt, bottom=2pt, right=2pt, colback=gray!15, colframe=white, fontupper={\ttfamily \footnotesize}}

%\usepackage{enumerate}
%\usepackage{graphicx}

%\citestyle{acmauthoryear}

\begin{document}
\title{Revisiting Schelling's Games}

\author{Brandon Hosley}
\orcid{0000-0002-2152-8192}
%\authornotemark[1]
%\authornote{text}
\email{brandon.hosley.1@us.af.mil}
\affiliation{%
	\institution{Air Force Institute of Technology}
	\streetaddress{1751 11th St.}
	\city{Wright-Patterson Air Force Base}
	\state{Ohio}
	\country{USA}
	\postcode{45433}
}


\begin{abstract}
	The purpose of this paper is to demonstrate competency in the learning 
	objectives of OPER 561-Discrete Event Simulation.
	Simultaneously, it will be used to practice writing in a format
	common within the field.
	Lastly it will be used to explore a topic that has been interesting
	to the author for some time, but had not yet been feasible to explore.
	The subject of the simulations in this paper will be the well-studied
	Schelling models. The simulations performed will not necessarily be
	novel, but are intended to take advantage of improvements in computation
	to explore some of Schelling original analysis in a simulated, experimental manner.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.

\received{10 March 2023}

% make the title area
\maketitle

\section{Introduction}

In this paper we will revisit the well-known Schelling Models\cite{Schelling1971}.
As an exercise, first we will explore the available tools to emulate his original
simulation but at a larger scale.
Afterward we will simulate the conditions that he investigated analytically.
Lastly we will extend the investigation to encompass scenarios that he had not
written about.

\subsection{Background and Motivation}

In 1971, while working for the RAND Corporation, Thomas C. Schelling began investigating
the manner in which segregation occurs in the absence of external enforcement.
To this end, Schelling proposed that groups of agents with similar objectives in their relations
with other agents would arrange themselves in a manner that resembled a directing hand.
While acknowledging that there are a multitude of contributing and compounding factors that can amplify these effects, 
for simplicity's sake Schelling chose to abstract the net prejudices, biases, and presences into a simple number.


In direct relevance to the civil rights movement in full swing at the time of his writing, Schelling chose to 
tie the intuition of his model to one of the most obvious traits that could classify differences between agents,
which was race. He did write about situations in which age could have a similar effect; as when groups of young people
begin spending a lot of time in certain areas displacing older persons that may find the teenage presence objectionable.

Schelling concluded his paper describing what he called tipping points, wherein fragile equilibrium breaks and send a local
demographic towards an extreme or even homogeneous outcome.

\section{Related Work}

Schelling's model offers a lot of opportunity to extend to a large variety of different conditions
and is very simple to understand, as such it has been the subject of numerous studies and experiments.
Here we will examine just a few of them, first several with interesting conditions that will not be considered
followed by several that have conditions similar to those that we wish to implement for this paper.


Bullinger et al. \cite{Bullinger2021} describe an analytical method to seek a pareto optimal
condition within a single assignment on arbitrary networks. 
This can become a fairly difficult task very rapidly,
if a feasible solution exists at all; but most importantly for this paper,
it does not make for compelling simulation.

Elkind et al.\cite{Elkind2021} utilize an approach in which agents occupy nodes on a graph rather than sectors on a grid.
In this way, many nodes have oppotunities to be less volatile as they have fewer neighbors, whereas
some nodes may have more than the eight connections associated with grid spacing.
While this dimension may prove interesting in that paper they never examine a node with greater than five connections.

Kreisel et al. \cite{Kreisel2022} also examined methods of analytically calculating equilibrium.
In their work they focus on the computational complexity of evaluating equilibrium,
and stick to the agents-on-graph type of models.

Gretha et al.\cite{Gretha2018} applied the Schelling model to social networks. The observed clustering similar,
though not as well defined delineations as most models. This type of model offers the opportunity to generate
far more connections than most implementations, and greatly changes the manner in which these connections 
affect the utility of the agents.

Bilo et al.\cite{Bilo2022} added a cost associated with moving, that scaled with distance.
While this did not change the probability of achieving equilibrium it did increase the amount
of time for the system to find equilibrium.
Additionally, it had the effect of increasing the probability of reaching an equilibrium with
smaller neighborhoods, which was not unusual in other implementations, just less common.

Kanellopoulos et al.\cite{Kanellopoulos2021} implement a model in which there are more than the typical two classes of agent.
Additionally, they differing levels of tolerance between different groups. T
his work is highly related to Liu et al.\cite{Liu2019} who also add a larger number of classifications of agents,
however, rather than using different levels of tolerance defined specifically between each pair of classes,
they provide multiple traits for each class with a utility associated positively with agents that share
like traits. They observed that agents still formed neighborhoods with their own classification and were far
more likely to share borders with classes of agents that shared traits.
They also examined changes in density and increasing the levels of tolerance; where increased tolerance
and decreased system density both (unsurprisingly) had the effect of dissolving neighborhoods such that
the graphic representation resembled a multicolored Perlin noise.


\section{System Models and Problem Formulation}
\subsection{Optimization}

The simulation model was based on a previous implementation provided by Dr. Lance Champagne.
However, the original model was not optimized.
The run time for a \(100\times100\) generating \(50\) frames executed in a visual studio code python notebook run
on a 2021 M1 macbook pro was consistently \(18.1\pm1\) seconds.
While this is not necessarily problematic for running this simulation a small number of times,
we determined that the run time would only get worse as we adding complexity by modeling more complex behaviors,
before long, this would have a profound negative effect for iterative development and gathering data from a large number of runs
and this was determined to be unacceptable, and thus the base model would need to be optimized.

First, we changed all of the functions using indexed iterations by passing an iterative object instead,
we changed the manner in which each agent checks its neighbors.
Rather than calculating the combination of the agent's coordinates by subtracting one, adding zero, and adding one,
we calculated a range based on the agent's coordinate once and iterated over that instead.
Finally, there was an extra checking happiness routine prior to passing all the functions to matplotlib's
animation generator, determining this to be redundant we removed it.
These actions reduced the run time to \(6.8\pm1\) seconds.
This was a good improvement; but inspired by the Icarus statue in the courtyard of the AFIT campus we decided to continue.


We changed all of the occurrences in which the \inlinecode{gridsize+1} was called with a variable calculated once.
But this did not improve the time, likely because that simple of a call was likely already simplified by the python interpreter.
Next, focus was given to the manner in which agent chose their next destination, first, agents were randomly picking 
a set of coordinates and checking the prior grid to see if that sector was occupied and then moving there.
The problem was that there was no accounting on the original grid so multiple agents could choose to move to the same empty zone.
We adding an update to the old grid so that this behavior wouldn't occur. Additionally, at the movement
step we chose to make a list of all unoccupied zones at the beginning, then unhappy agents would randomly pick an opening from
this list rather than using an acceptance-rejection technique.
The chosen coordinates were then removed from that choice list so that there would not be multiple agents moving into the same zone.
These changes reduced the run time to \(5.8\pm1\) seconds.

Next, we discovered a call for a random integer that did not seem to serve a purpose.
While it may have been used to advance the random number generator to increase the entropy of the system,
the python random package has a cycle large enough that this should have a negligible benefit.
We also removed the system for updating the old grid to account for agents moving,
since choosing from the openings list had this effect anyway.
We implemented the same accounting system for placing the agents the first time,
wherein at the first iteration the openings list comprised the coordinates of for the entire grid.
While the initial usage of this is relatively inefficient, as the grid gets larger and more agents must be placed,
this drastically improves the time it takes to place the agents by eliminating one more acceptance-rejection scenario.
All of this brought the baseline scenario's run time to \(3.8\pm1\) seconds.

\subsection{Conditions to be Examined}

Schelling's initial model had an equal homophily for all agents across both demographics.
This is also the case for the baseline model, so we will examine this condition as a 
control by which to compare the other conditions.

We are interested in examining effects of asymmetric utility, differences in population density,
and larger numbers of group types. Additionally, we will investigate effects of changes in
the size of what agents consider their neighbors and add integrationist utility.

The preceding are all scenarios that Schelling modeled physically, we will be able to compare
results to those originally described; what Schelling was unable to do was model what he described
as tolerance schedules or distributions of differences in tolerance among the agents.
He did provide an analytic claim to what behavior would occur, 
we wish to examine how this behavior manifests in simulation.

One aspect that we will depart with from Schelling's conceptualization is the openness of the system,
in his analysis he focused on a limited area with access to an arbitrary external population
and where the entire area is treated as a singular neighborhood. Without an open system with 
a smaller segment of interest it may tipping will not likely happen in the manner that he described.
However, we wish to investigate how the agents of his analytical models will behave in a closed system.

Finally, we will extend our model to include some of the traits shown by other researchers,
with emphasis on different numbers of groups, and nonstandard utility functions.

\subsection{Assumptions}

Assumptions used in this set of experiments are the same as those used in most implementations.
Specifically, we eschew the cost of moving, we assume that the agents play the game with perfect information,
that geographic limitations do not exist beyond occupation, and that all neighborhoods are arranged ortholinearly.

\subsection{Building the Model}

The process of actually building the model occurred iteratively.
Each additional feature or condition added ot the scenario added some complexity to building the model.
The intent being that once the model is build that the one would be able to simulate all of the above.

The easiest and first add was to abstract the the number of agents.
This led to the restructuring of the initiation template, now a dictionary will be used to pass
features into the model.
Initiation consists of iterating over the dictionary when building all of the agents.
Within this data structure we add a population definition to let us control the population of each type of agent.
This definition is the way for a user to control the types of agents, the populations of each type, 
and by extension can control the population density.

To vary the levels of tolerance each agent type was assigned a tolerance value within the dictionary,
this allowed different agents to express different levels of tolerance.
The remaining conditions involved more complex implementations of tolerance.
In order to achieve this it was decided to replace the tolerance trait with a utility function instead.
The change to utility function allowed an easier definition of differing tolerance levels of other out-groups.

The last set of conditions involved agents within groups having different levels of tolerance than their peers.
To achieve this, anonymous function casting was leveraged so that instantiation of each agent
unwrapped the first function call which would assign a variable parameter to the utility function assigned to the agent.

\subsection{Experiment Design}

For each of the scenarios examined we will run 10 simulations with 100 rounds of movement and collect the metric
of aggregate dissatisfaction among agents, these parameters were chosen because they had reasonable run time
and were stable in the kernel on the hardware that we were using. 
Running additional simulations frequently caused the kernel to seize.
It was decided that these number should be sufficient for an exploratory analysis.

We will then to one additional run to output an animated visualization of that scenario.
Schelling put particular emphasis on the qualitative patterning of the visual representation of his models,
we will also primarily use qualitative to seek generalize insight into the scenarios, with the goal of 
determining which conditions suggest more in depth analysis.
In an effort to add some objective measurements as well, we will leverage that aggregate dissatisfaction over time
to determine if the system is able to reach a Pareto efficiency, where the value of the convergence represents
continuous movement, and stable equilibrium will occur if dissatisfaction converges to zero.

Dissatisfaction curves will also provide a tool with which to compare scenarios.

\section{Simulation Results and Discussion}




\section{Conclusion and Future Work}



There are several other metrics that may provide some insight into the system state, in particular we believe that 
counts of contiguous groups and a metric evaluating the irregularity of borders between clusters may provide some interesting insight.

\bibliographystyle{ACM-Reference-Format}
\bibliography{SimulationProject}

\end{document}