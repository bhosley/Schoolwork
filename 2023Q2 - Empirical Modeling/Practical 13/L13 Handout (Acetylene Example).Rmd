---
output:
  pdf_document: default
  html_document: default
---
---
title: "Lesson 13 Practical Exercise"
footer: `r paste('Lesson 13 Practical Exercise')`
date: "`r format(as.Date(c('2021/05/10')), '%d %B %Y')`"
output:
  pdf_document:
    df_print: kable
  html_document:
    df_print: paged
  slidy_presentation:
    code_folding: hide
    fig_caption: yes
    smart: no
keep_tex: yes
graphics: yes
---

# 1. Preliminaries

```{r intro, echo=FALSE,message=FALSE, warning=FALSE}
source('C:/Users/placasse1/Desktop/LaCasse/OPER 679/scripts/R/setup.R')
shiny::includeCSS('C:/Users/placasse1/Desktop/LaCasse/OPER 679/scripts/css/flat-slidy.css')
shiny::includeScript("C:/Users/placasse1/Desktop/LaCasse/OPER 679/scripts/js/jquery.min.js")
shiny::includeScript(system.file('C:/Users/placasse1/Desktop/LaCasse/OPER 679/scripts','js','tpt-scroll.js'))
shiny::includeScript(system.file('C:/Users/placasse1/Desktop/LaCasse/OPER 679/scripts','js','hideout.js'))
library(xlsx)
library(printr)
library(xtable)
library(formatR)
library(ridge)
library(pls)
library(MASS)
library(car)
options(xtable.comment = FALSE, xtable.type="latex")
```

# Perform data housekeeping - upload data for Example 9.1; name columns, display to make sure it reads properly, etc. 

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

# 2. Example 9.1 (p. 290-292)
## a) Create scatterplot of ContactTime versuse ReactorTemperature.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## b) Scale regressor variables using unit normal scaling.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## c) Fit second order model using scaled regressors, to include two-way interaction terms. Compare to Table 9.2 on p. 293.

Note: Can do this model the "long way", i.e. lm(y ~ x1 + x2 + x3 + x1x2 + x2x3... etc.) or using polym() function in R.
Model output for the polym() shortcut uses a particular notation. Don't get confused - know what you're looking at.
Model both ways and use each model to decipher the polum() output.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## d) Reproduce Table 9.3 on p. 295.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## e) Using Table 9.3 data, define an X matrix and perform eigensystem analysis of X'X. Compare to Table 9.10 on p. 316.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## f) Calculate kappa values and compare to p. 298.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

# 3. Example 9.2 (p.307-308)

## a) Perform ridge regression (by hand) using the standardized data from Table 9.3. Devine the parameter k as a constant and vary to reproduce Table 9.8 on p. 308.

Note: The textbook leaves off the intercept term. This is because the response and the regressors are both centered and scaled. Due to rounding, the output will give a small B_0 coefficient. We could also drop the vector of ones from X

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## b) There is also a package to perform ridge regression automatically.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

# 4. Example 9.3 (p.316-319)

## a) Perform Principal Component Regression using the pcr() function. Display $coefficients, $loadings, and $scores. Compare to Table 9.12 on p. 318 and Table 9.10 on p. 3.16.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

## b) Perform Principal Component Regression (by hand) using the following steps:

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

### 1) Define matrix of eigenvectors of xTx, where X is defined by standardized variables (Table 9.3).

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

### 2) Calculate Z; omit intercept row/column because variables are standardized. Compare to $scores output from pcr().

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

### 3) Obtain least squares estimators for $\alpha$.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

### 4) Define vector of ones and zeros to determine cutoff of principal components to use.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

### 5) Define $\alpha_{pc}$ as per p.315 (equation not numbered). Note that this is term-by-term multiplication, not the dot product.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```

### 6) Calculate $\beta_{pc}$ using Equation 9.10. Compare results to Table 9.12 on p. 318. Vary B vector to obtain standardized estimates in columns A, B, C, D, and E.

```{r, echo=T, tidy=TRUE, tidy.opts=list(width.cutoff=60)}

```