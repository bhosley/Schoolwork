\documentclass[12pt]{amsart}


%\usepackage[notref,notcite]{showkeys}
\usepackage{verbatim}
\usepackage{fullpage}
\usepackage{amsfonts}
\usepackage{bbm}
\usepackage{wrapfig}
\usepackage{enumerate}
\usepackage{float}
\usepackage{hyperref}
\usepackage[left=0.5in, right=0.5in, bottom=0.75in, top=0.75in]{geometry}
\setlength{\parindent}{0pt}


\usepackage{color}
\usepackage{colortbl}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{fancybox}

\newcommand{\1}{\mathbbm{1}}

\newcommand{\eps}{\varepsilon}
\newcommand{\la}{\lambda}
\newcommand{\Contradiction}{\Rightarrow\Leftarrow}
\DeclareMathOperator{\lspan}{span}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ran}{ran}
\DeclareMathOperator{\diag}{diag}
\providecommand{\abs}[1]{\lvert#1\rvert}
\providecommand{\norm}[1]{\lVert#1\rVert}
\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}

\newcounter{Theorem}
\newcounter{Definition}
\numberwithin{equation}{section}
\numberwithin{Theorem}{section}

\theoremstyle{plain} %% This is the default, anyway
\newtheorem{thm}[Theorem]{Theorem}
\newtheorem{cor}[Theorem]{Corollary}
\newtheorem{lem}[Theorem]{Lemma}
\newtheorem{prop}[Theorem]{Proposition}
%\usepackage{upgreek}

\theoremstyle{definition}
\newtheorem{defn}[Theorem]{Definition}

\theoremstyle{remark}
\newtheorem{remark}{Remark}[section]
\newtheorem{ex}[Theorem]{Example}
\newtheorem{nota}[Theorem]{Notation}



\begin{document}

\thispagestyle{empty}

\noindent{\Large Homework 4 (Due October 28 at 8am)}\bigskip


\begin{enumerate}[1.]



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\item
For any integer $N>2$, the \textbf{difference operator (discrete derivative)} is the operator
\begin{equation*}
\mathbf{D}:\mathbb{F}^{N}\rightarrow\mathbb{F}^{N-1},\quad(\mathbf{D}\mathbf{x})(n):=\mathbf{x}(n+1)-\mathbf{x}(n).
\end{equation*}
Show that $\mathbf{D}$ is linear, and in the specific example of $N=4$, find the $3\times 4$ matrix representation of $\mathbf{D}$.

\bigskip
\hrule
\bigskip

\begin{proof}
	Let \(c_1,c_2 \in \mathbb{F}\) and \( \mathbf{x}_1, \mathbf{x}_2 \in \mathbb{F}^N \) be arbitrary.
	Then for any \(n\in [N]\),
	\begin{align*}
		[\mathbf{D}(c_1\mathbf{x_1} + c_2\mathbf{x_2})](n)
		&= (c_1\mathbf{x_1} + c_2\mathbf{x_2})(n+1) - (c_1\mathbf{x_1} + c_2\mathbf{x_2})(n) \\
		&= (c_1\mathbf{x_1})(n+1) + (c_2\mathbf{x_2})(n+1) - (c_1\mathbf{x_1})(n) - (c_2\mathbf{x_2})(n) \\
		&= (c_1\mathbf{x_1})(n+1) - (c_1\mathbf{x_1})(n) + (c_2\mathbf{x_2})(n+1) - (c_2\mathbf{x_2})(n) \\
		&= c_1(\mathbf{x_1}(n+1) - \mathbf{x_1}(n)) + c_2(\mathbf{x_2}(n+1) - \mathbf{x_2})(n) \\
		&= c_1(\mathbf{D}\mathbf{x_1})(n) + c_2(\mathbf{D}\mathbf{x_2})(n) \\
		&= (c_1\mathbf{D}\mathbf{x_1} + c_2\mathbf{D}\mathbf{x_2})(n).
	\end{align*}
	Thus, $\mathbf{D}$ is linear.
\end{proof}
The function \(\mathbf{D}\) can be represented by the matrix \(\mathbf{A_D}\) where \(N=4\) as
\[
\mathbf{A_D} = \begin{bmatrix}
	-1 & 0 & 0 & 0 \\
	1 & -1 & 0 & 0 \\
	0 & 1 & -1 & 0 \\
\end{bmatrix}
\begin{matrix}
	\\ \\ \\ .\\
\end{matrix}
\]

\bigskip
\hrule
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\item
Let $\mathbf{1}\in\mathbb{F}^N$ be the \textbf{all-ones vector} defined by $\mathbf{1}(n)=1$ for all $n\in[N]$.

Show that $\mathbf{D}\mathbf{x}=\mathbf{0}$ if and only if $\mathbf{x}$ is a scalar multiple of $\mathbf{1}$, that is, that
\begin{equation*}
\ker(\mathbf{D})
=\{\mathbf{x}\in\mathbb{F}^N: \mathbf{D}\mathbf{x}=\mathbf{0}\}
=\{c\mathbf{1}: c\in\mathbb{F}\}.
\end{equation*}

\bigskip
\hrule
\bigskip

\begin{proof}
	(\(\mathbf{x}=c\mathbf{1} \Rightarrow \mathbf{D}\mathbf{x}=\mathbf{0}\))
	Let \(n\in[N]\) be arbitrary. Then, when \(\mathbf{x}=\mathbf{1}\),
	\[ \mathbf{D}(\mathbf{1})(n) = \mathbf{1}(n+1) - \mathbf{1}(n) = 1 - 1 = 0 \]
	and since $\mathbf{D}$ is linear, for arbitrary \(c\in\mathbb{F}\)
	\[ \mathbf{D}(c\mathbf{1})(n) = c\mathbf{D}\mathbf{1}(n) = c0 = 0.\]
	Thus \(\mathbf{D}(c\mathbf{1}) = \mathbf{0}\). \\
	
	\noindent
	(\(\mathbf{D}\mathbf{x}=\mathbf{0} \Rightarrow \mathbf{x}=c\mathbf{1}\))
	Let \(n\in[N]\) be arbitrary. Then for any \(\mathbf{x}_0\in\operatorname{ker}(\mathbf{D})\),
	\begin{align*}
		\mathbf{D}\mathbf{x}_0 &= \mathbf{x}_0(n+1) - \mathbf{x}_0(n) = \mathbf{0}
		\intertext{or equivalently, }
		\mathbf{x}_0(n) &= \mathbf{x}_0(n+1). 
	\end{align*}
	Thus, since every element in any $\mathbf{x}_0$ is arbitrary but equal, which is equivalent to $c\mathbf{1}$.
\end{proof}

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\item
For any integer $N>2$, the \textbf{cumulative sum (discrete integral)} is the operator
\begin{equation*}
\mathbf{S}:\mathbb{F}^{N-1}\rightarrow\mathbb{F}^{N},\quad(\mathbf{S}\mathbf{y})(n):=\left\{\begin{array}{cl}0,&n=1,\\\displaystyle\sum_{k=1}^{n-1}\mathbf{y}(k),&n>1.\end{array}\right.
\end{equation*}
Show that $\mathbf{S}$ is linear, and in the specific example of $N=4$, find the $4\times 3$ matrix representation of $\mathbf{S}$.

\bigskip
\hrule
\bigskip

\begin{proof}
	Let \(c_1,c_2 \in \mathbb{F}, \mathbf{y}_1, \mathbf{y}_2 \in \mathbb{F}^{N-1} \) and \(n\in [N-1]\) be arbitrary.
	Then, when $n=1$ we see that
	\begin{align*}
		\mathbf{S}(c_1\mathbf{y}_1 + c_2\mathbf{y}_2)(1) &= 0
		\intertext{and}
		(c_1\mathbf{S}\mathbf{y}_1 + c_2\mathbf{S}\mathbf{y}_2)(1) &= c_10 + c_20 = 0.
	\end{align*}
	When $n>1$,
	\begin{align*}
		\mathbf{S}(c_1\mathbf{y}_1 + c_2\mathbf{y}_2)(n) 
		&= \sum_{k=1}^{n-1}(c_1\mathbf{y}_1 + c_2\mathbf{y}_2)(k) \\
		&= \sum_{k=1}^{n-1}(c_1\mathbf{y}_1)(k) + (c_2\mathbf{y}_2)(k) \\
		&= \sum_{k=1}^{n-1}c_1\mathbf{y}_1(k) + \sum_{k=1}^{n-1}c_2\mathbf{y}_2(k) \\
		&= c_1\sum_{k=1}^{n-1}\mathbf{y}_1(k) + c_2\sum_{k=1}^{n-1}\mathbf{y}_2(k) \\
		&= c_1(\mathbf{S}\mathbf{y}_1)(n) + c_2(\mathbf{S}\mathbf{y}_2)(n) \\
		&= (c_1\mathbf{S}\mathbf{y}_1 + c_2\mathbf{S}\mathbf{y}_2)(n).
	\end{align*}
	Therefore $\mathbf{S}$ is linear in both cases.
\end{proof}

The function \(\mathbf{S}\) can be represented by the matrix \(\mathbf{A_S}\) where \(N=4\) as
\[
\mathbf{A_S} = \begin{bmatrix}
	0 & 0 & 0 \\
	1 & 0 & 0 \\
	1 & 1 & 0 \\
	1 & 1 & 1 \\
\end{bmatrix}
\begin{matrix}
	\\ \\ \\ .\\
\end{matrix}
\]

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\item
Prove the discrete version of one-half of the Fundamental Theorem of Calculus, namely that:
\begin{equation*}
\mathbf{D}(\mathbf{S}\mathbf{y})=\mathbf{y},\quad\forall\,\mathbf{y}\in\mathbb{F}^{N-1}.
\end{equation*}

\textit{Hint: For any $n\in[N-1]$,
note $[\mathbf{D}(\mathbf{S}\mathbf{y})](n)=(\mathbf{S}\mathbf{y})(n+1)-(\mathbf{S}\mathbf{y})(n)$ and then use the definition of $\mathbf{S}$.}

\textit{Note: In class, we will discuss how operator composition corresponds to matrix multiplication.
In particular, the statement that $\mathbf{D}(\mathbf{S}\mathbf{y})=\mathbf{y}$ for all $\mathbf{y}$ is equivalent to having $\mathbf{D}\mathbf{S}=\mathbf{I}$.
For example, when $N=4$, multiplying the $3\times 4$ and $4\times 3$ matrices you found in the previous problems should yield a $3\times 3$ identity matrix.
Here, we caution that $\mathbf{S}\mathbf{D}\neq\mathbf{I}$ and moreover that $\mathbf{D}$ is not invertible.}

\bigskip
\hrule
\bigskip

\begin{proof}
	Let \(n\in[N-1]\) and \(\mathbf{y}\in\mathbb{F}^{N-1}\) be arbitrary.
	When $n=1$,
	\begin{align*}
		[\mathbf{D}(\mathbf{S}\mathbf{y})](1)
		&= (\mathbf{S}\mathbf{y})(2)-(\mathbf{S}\mathbf{y})(1) \\
		&= \sum_{k=1}^{2-1}\mathbf{y}(k) - 0 \\
		&= \mathbf{y}(n).\\
	\end{align*}
	When $n>1$,
	\begin{align*}
		[\mathbf{D}(\mathbf{S}\mathbf{y})](n)
		&= (\mathbf{S}\mathbf{y})(n+1)-(\mathbf{S}\mathbf{y})(n) \\
		&= \sum_{k=1}^{n}\mathbf{y}(k) - \sum_{k=1}^{n}\mathbf{y}(k) \\
		&= \mathbf{y}(n) + \sum_{k=1}^{n-1}\mathbf{y}(k) - \sum_{k=1}^{n}\mathbf{y}(k) \\
		&= \mathbf{y}(n).
	\end{align*}
	Thus \(\mathbf{D}(\mathbf{S}\mathbf{y})=\mathbf{y}\) for all \(\mathbf{y}\in\mathbb{F}^{N-1}\).
\end{proof}

\bigskip
\hrule
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\item
Putting the previous problems together with results from class,
show that for any $\mathbf{y}\in\mathbb{F}^{N-1}$ the equation $\mathbf{D}\mathbf{x}=\mathbf{y}$ has a solution, and moreover, that the set of all solutions $\mathbf{x}$ to this equation is
\begin{equation*}
\{\mathbf{x}\in\mathbb{F}^N: \mathbf{D}\mathbf{x}=\mathbf{y}\}
=\{\mathbf{S}\mathbf{y}+c\mathbf{1}: c\in\mathbb{R}\}.
\end{equation*}

\textit{Note:
The fact that $\mathbf{D}\mathbf{x}=\mathbf{y}$ has a solution for any $\mathbf{y}\in\mathbb{F}^{N-1}$ implies that the image of $\mathbf{D}$ is its codomain.
In general, when this occurs, we say the operator is \textbf{onto (surjective)}.
In this particular instance, we see that any discrete function $\mathbf{y}$ is the discrete derivative of other discrete functions $\mathbf{x}$,
one of which is the discrete integral $\mathbf{S}\mathbf{y}$ of $\mathbf{y}$;
all other solutions are obtained by adding an arbitrary constant discrete function $c\mathbf{1}$ to it.}

\bigskip
\hrule
\bigskip

Using Theorem 2.4(a):
for any $\mathbf{y}\in\mathbb{F}^{N-1}$, the equation
$\mathbf{D}\mathbf{x}=\mathbf{y}$ has a solution
if and only if $\mathbf{y}\in\mathbf{D}(\mathbb{F}^N)$ and that when this occurs
\[\mathbf{x_0} + \operatorname{ker}(\mathbf{D}) = 
	\{\mathbf{x_0} + \mathbf{x} : \mathbf{x}\in\operatorname{ker}(\mathbf{D})\}.\] 

\begin{proof}
	As shown in problem 2
	\begin{equation*}
		\ker(\mathbf{D})
		=\{\mathbf{x}\in\mathbb{F}^N: \mathbf{D}\mathbf{x}=\mathbf{0}\}
		=\{c\mathbf{1}: c\in\mathbb{F}\}.
	\end{equation*}
		
	
	In problem 4 it was shown that 
	$\mathbf{D}(\mathbf{Sy}) = \mathbf{y}$ for all $\mathbf{y}$.
	
	Thus,
	\[\mathbf{x_0} + \operatorname{ker}(\mathbf{D}) = 
		\{\mathbf{x_0} + \mathbf{x} : \mathbf{x}\in\operatorname{ker}(\mathbf{D})\}.\] 
\end{proof}

\bigskip
\hrule
\bigskip

\item Let \(\mathcal{V}\) be a finite-dimensional vector space over a field \(\mathbb{F}\). Prove that a subset \(\mathcal{W}\subset\mathcal{V}\) is a subspace if and only if there exists a linear function \(\mathbf{L}:\mathcal{V}\to\mathcal{V}\) such that \(\mathcal{W}=\operatorname{ker}(\mathbf{L})\). 

Hint: Let \(M = \operatorname{dim}\mathcal{W}\) and let \(\{w_{n}\}_{n=1}^{M}\) be a basis for \(\mathcal{W}\). Extend this to a basis (by a theorem from class) for \(\mathcal{V}\), define \(\mathbf{L}\) on this basis, and extend linearly (by a theorem from homework).


\bigskip
\hrule
\bigskip




\vspace*{\fill}
\item No EigenQuiz assignment this week!

\end{enumerate}



\end{document}